# Amazon Elastic Block Store(EBS)

## Overview

EC2向けに設計された高性能でスケーラブルなブロックストレージサービス。  
ブロックストレージは、物理的なディスクやマシンの記録領域をブロック単位で切り出して管理するストレージサービスであり、更新頻度が高く高速なアクセスが要求される場合に利用できる。
※EBSはEC2インスタンスにアタッチすることで利用できるようになり、データを保存できます。また、RDSのデータ保存先としても利用できる。

EC2にアタッチするだけで利用できるEBSですが、ボリュームタイプはいくつもの種類があります。それぞれ性能もコストも違いますので、要件に応じて最適なボリュームを選択できるかどうかが問われます。判断基準を知るためにも、まずはEBSボリュームの種類やEBSのサービスの特徴について押さえておきましょう。

## EBSの特徴

- 耐久性に優れたスナップショット機能によるバックアップやリストア
- ディスクデータの暗号化機能
- 99.999%の高い可用性

### EBSスナップショット

EBSスナップショットを作成することで、データをS3にバックアップできる。  
EBSスナップショットでは最後にスナップショットを作成した時点からボリューム上で変更のあるブロックだけを保存する**増分バックアップ方式を採用**しており、バックアップの所要時間が短いという特徴。  
Amazon Data Lifecycle Manager(DLM)を使用してEBSスナップショットから保存、削除のサイクルを自動化できます。

### 暗号化機能

ボリューム内に保存されるデータ、ボリュームとインスタンスの間でやり取りされるデータ、スナップショットを暗号化することで、データを保護できる。  
データを暗号化するためには暗号化オプションを選択する必要がある。  
暗号化の有効化以降は、EBSボリュームから取得したスナップショットも暗号化の対象になります。

### 高可用性

EBSはAZ内で自動的に複製され、99.999%の可用性を維持するように設計されています。しかし、EBSも壊れるリスクは当然存在するため、定期的にスナップショットを取得するなどしてリスクヘッジをすることが重要。

### データの永続性

インスタンスストアとは異なり、EC2インスタンスを停止してもデータはEBSに保存される。
インスタンスストアのメリットはホストコンピューターのローカル環境を利用するため、EBSと比較しスループットなどのパフォーマンスが高く低レイテンシーであるところ。  
そのため、更新頻度が高い情報の保存先としては最適です。デメリットとしては揮発性ボリュームであるため、EC2が停止すると同時にデータが失われる恐れがあります。

### 柔軟性

EC2を停止したり、EBSをデタッチしたりせずに、容量・ボリュームタイプの変更ができます。なお、容量に関しては拡張できる一方**縮小はできない**ため、過度に容量を拡張すると費用面で運用に支障をきたす可能性がある。  
よって、容量を拡張する場合は今後のデータ容量の増減を検討し、状況によって新規のEBSを追加でアタッチするなどの対応を検討するのがよい。

## EBSボリュームの種類

EBSではSSDとHDDのボリュームをサポートしており、用途によってボリュームタイプを選択できる。  
EBSボリュームの種類ごとの性能や特徴は次の表のようになる。

[![Image from Gyazo](https://i.gyazo.com/14fbe35cecb3e8b1535fd3451d7a3d0a.png)](https://gyazo.com/14fbe35cecb3e8b1535fd3451d7a3d0a)

[![Image from Gyazo](https://i.gyazo.com/011ceebc160ebb0197c10591e15cd004.png)](https://gyazo.com/011ceebc160ebb0197c10591e15cd004)

### 汎用SSD

EC2インスタンス作成時にデフォルトでアタッチされるボリュームタイプです。料金とパフォーマンスのバランスがよく、開発環境やテスト環境などを含むほとんどの用途に適しています。

### プロビジョンドIOPS SSD

もっとも性能とコストが高いボリュームタイプ。  
低レイテンシーまたは高スループットを求められる場合に適しています。EBSボリュームの中で唯一、**複数のインスタンスにアタッチ（マルチアタッチ）することが可能**

### スループット最適化 HDD

安定したスループットを必要とする場合に適しているボリュームタイプ。  
ログ処理、ビッグデータ向けのデータストア、データウェアハウスなど、I/Oサイズが大きくアクセス頻度の高いシステムに最適。

### コールドHDD

EBSボリュームの中でもっとも低コストなボリュームタイプ。  
ログの保管やバックアップなど低速でアクセス頻度が低く、かつ大容量なデータを格納するのに最適となっています。容量制限があるので注意が必要です（S3は容量無制限）  
