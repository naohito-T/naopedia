# AWSで実現するモダンアプリケーション入門



## 第3章


### The Twelve-Factor app

2012年ごろにheroku社のエンジニアによって提唱されたアプリケーションを実装するためのベストプラクティス。  
どのようなプログラミング言語でも幅広く適用ができる。

### beyond The Twelve-Factor app

2016年ごろにPiotal社のエンジニアによって提唱されたベストプラクティス。15種類から構成されている。クラウドについても考慮されている。


## プラクティスの内容

### コードベース

コードベースとアプリケーションを1:1の関係になっていること、そしてアプリケーションとデプロイが`1:N`の関係になっていることが重要。  
よってアプリケーションの種類ごとにコードベースを作り、コードベースから本番環境/ステージング環境/開発環境など、複数の環境に異なるバージョンをデプロイする。


複数のアプリケーションから同じコードベースを参照すると依存度が高くなるため、ライブラリとして切り出す判断が必要になる。

このコードベースを実現するサービスにGitHubなどがある。
>そして、1つのアプリケーションで1つのリポジトリを持ち、それぞれの環境にデプロイをしているため、TheTwelveFactorAppの「コードベース」を満たしています。

### 依存関係管理

アプリケーションで依存関係を厳密に宣言する必要。  
依存関係を厳密に宣言する手段の例を挙げると、RubyGemsのGemfileで依存関係を宣言し、Bundlerの`bundle exec`コマンドで依存関係を分離します。  

また、システムツールの暗黙的な存在も認めない。
具体的な例としては、アプリケーションからOSに組み込まれているcurlコマンドを使ってしまうと、暗黙的に依存してしまいます。そこでRubyのnet/httpやFaraday、Pythonのrequestsなど、専用ライブラリを使います。また、画像処理のためにImageMagickなどに依存している場合は、明示的にImageMagickをインストールします。このように、暗黙的に依存することを避けることが重要です。

### 設定 機密情報 コード

設定をコードから分離する。  
設定とは**環境ごとに異なる値のことを指す。**

これらの設定をアプリケーションに定数として定義してしまうと、設定とコードを分離できず、TheTwelveFactorAppに違反する。  
また、`Ruby on Rails`など、アプリケーションフレームワークによっては、環境ごとの設定を設定ファイルという形式で管理するしくみが含まれていることもあります。
このしくみを使った場合、コードの中には直接設定を記述しませんが、同じコードベースの中には保持していることになります。これは、アプリケーションフレームワークのお作法に沿ってはいるものの、設定とコードを分離するという根本的な解決には至っていない。  

Beyond the TwelveFactor Appでは、設定を外部化するというベストプラクティスが追加されている。
クラウド上などのバックエンドサービスに設定を保存し、アプリケーションでは設定をそこから取得することを意味しています。そうすれば、設定自体を一元管理できるだけでなく、バックエンドサービス上のしくみを使って設定の履歴管理をしたり、アクセス制限もできます。


### APIファースト

### デザイン・ビルド・リリース 実行


### ログ

