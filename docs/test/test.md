# test

## テストの考え方

サーバー側では console.log()のような簡単なテストから始めると良い。
テストをしたというコードが残るのが何よりも良い。エビデンスになる。
APIテストのエンドポイントのメソッドでWeb APIをcallしているような場合は、それをmock化してWeb APIがcallされないようにすべき。



## E2Eテスト(End to End)

**E2EテストとはUI(User Interface)テスト**とも呼ばれ、システム全体を通してテストを行う。
Webサービスの場合はユーザと同じようにブラウザを操作し挙動が期待通りになっているかを確認することができる。

## ユニットテストとは(単体テスト)

[参考URL](https://qiita.com/takutoy/items/c684f761c655d832e5d2)

単体テストあるいはユニットテストとは、ソースコードの個々のユニット、すなわち1つ以上のモジュールが使用に適しているかどうかを決定するために関連する制御データ・使用手順・操作手順とともにテストする手法である。

- ユニットテストってなに

1. コードに欠陥を作りこむのを予防する
2. コードの欠陥を発見する
3. コードが正しく変更されたことを確認する。


## ユニットテスト vs インテグレーションテスト

クラスやメソッドを単体でテストすることをユニットテスト
他のクラスや外部モジュールと結合してテストすることをインテグレーションテストという


## テスト単語
インテグレーションテスト
動的テスト
静的テスト
コードレビュー
自動テスト
手動テスト
テストファースト
Test Driven Development(TDD)
コードカバレッジ
ホワイトボックステスト
ブラックボックステスト
境界値分析
同値分析

## カバレッジとは

IT関係でカバレッジとは、開発したソフトウェアのプログラムコードが試験された割合。

## CI/CD

昨今ではソフトウェア開発における様々な工程を自動化するような技術の開発や普及が進んでいる
その一つにCI(Continuous Integration、継続的インテグレーション)やCD（Continuous Delivery、継続的デリバリー）と呼ばれるものがある。

CIはソフトウェアのビルドやテストを自動化して頻繁に実行することでソフトウェアの品質向上や開発効率化を目指す手法で、CDはCIに加えてリリースやデプロイまでも自動化する手法。

DevOpsはアプリケーションの開発において必須の考え方となっている。
このCI/CDを実現する方法としては、**外部のサービスを使う方法**と**自前で専用のサーバーを用意して専用のツールを導入する方法**がある。

- 外部のサービス使用
Travis CIやCircle CIなどが有名
- 自前で専用のサーバを用意
Jenkins



## test word

- モックアップ
モックアップとは工業製品の設計・デザイン段階で**試作される外見を実物そっくりに似せて作られた実物大の模型のこと**

## スタブとモックの違い

スタブとモックの最大の違いは
**スタブは受信メッセージのテストのために使うもの**
**モックは送信メッセージのテストのために使うもの**



[参考URL](https://qiita.com/k5trismegistus/items/10ce381d29ab62ca0ea6#:~:text=%E3%82%B9%E3%82%BF%E3%83%96%E3%81%A8%E3%83%A2%E3%83%83%E3%82%AF%E3%81%AE%E6%9C%80%E5%A4%A7,%E3%81%84%E3%81%A3%E3%81%A6%E3%82%88%E3%81%84%E3%81%A7%E3%81%97%E3%82%87%E3%81%86%E3%80%82)

**スタブもモックもテストコード内で使うもの。**

テストを行うべきなのは次の2つについて

1. オブジェクトっが他のオブジェクトからメッセージを受け取ったとき、期待する答えを返すことができるか
  - 要するにパブリックメソッドに対するユニットテスト
  - 「オブジェクト指向設計実践ガイド」には、プライベートメソッドに対するテストは書くべきではない、さらにいうとプライベートメソッドを書くべきではない(プライベートメソッドを他のオブジェクトに切り出して注入せよ)とあります。
  - オブジェクトが副作用のあるメッセージ送信を行うとき、その回数や引数が適切か。
  - ログを書く、とかネットワークアクセスを行うといった副作用が伴う場合は回数も検証しないといけません。「メッセージをTwitterに投稿する」メソッドを使う場合、このメソッドが想定していない形で何回も繰り返し呼ばれるようなことはあってはなりません。


## tips

[mockを使ったNode.js(Express)のAPIテスト](https://qiita.com/yuta-katayama-23/items/2ee51d41153359e56335)
[Jest/Supertestを使用したnode.js(express)のAPIテスト](https://qiita.com/yuta-katayama-23/items/29b91fed629fe758a42d)


## node

Node.js(Express)でServer Sideを構築する場合、外部のWeb APIを実行しデータを取得することも多くある。
その際にUnitTestやAPIテストで実際に通信を行なってしまうと、テストとして動作が不安定になるなどの問題が発生してし歌め

## CI/CD

[参考URL](https://casualdevelopers.com/tech-tips/how-to-install-and-use-jenkins-on-docker-for-nodejs/)

## Jenkins

Job DSLとは
Job DSLとはJenkinsの新しいジョブの設定をDSL(Domain Specific Language)で書いておき、それを読み込むだけでGUIをつかずに新しいジョブを作成する仕組み。
昨今はinfrastructure as code(laC)と言われているようにインフラであっても人が手動で設定するのではなく、設定をソースコードにして自動的に設定をされるべき。

[これをやる](https://casualdevelopers.com/tech-tips/how-to-install-and-use-jenkins-on-docker-for-nodejs/)

## シナリオテスト

シナリオテストとは**ユーザーが一連の流れに沿ってシステムを問題なく利用できることを確認するためのテスト**
ユーザーがシステムを問題なく利用できることとあるように、ユーザー視点での確認がメインとなる。
そのため、総合テスト、受け入れテストなどでこのテスト技法が用いられます