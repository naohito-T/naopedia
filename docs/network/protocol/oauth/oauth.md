# OAuth

[一番分かりやすい OAuth の説明](https://qiita.com/TakahikoKawasaki/items/e37caf50776e00e733be)

OAuth = 認可(権限の認可) : 行動やリソースの許可をすること

**権限の認可を行うため**のオープンスタンダードである。

まず、前提知識として、OAuthという『アクセストークンを発行する仕組み』がある。
アクセストークンは、アプリケーションをAPI経由で操作するときなんかに使われる。
例としてTwitterクライアントを自作するときにアクセストークンを使ったりします。

**このOAuthは前述のとおりアクセストークンを発行する仕組みであって、認証については定められていません。認証に必要な、ユーザー情報などの取得については決まっていない。**

このOAuthを拡張し、ユーザー情報の取得についてなどを標準化したのがOpenID Connectが策定された。


## OpenID Connect

>OAuth 2.0を使ってID連携をする際に、OAuth 2.0では標準化されていない機能で、かつID連携には共通して必要となる機能を標準化した』OAuth 2.0の拡張仕様の一つである

- OpenID Connectによる認証のフロー
このOpenID Connectは広く使われている認証方法のためフローを押さえておく。
**まずIDトークンというユーザ情報が含まれたアクセストークンがあり、これを次のフローでやりとりする。**

| 順番 | リクエスト元 | 相手 | 内容 |
| --- | --- | --- | --- |
| 1 | クライアント | プロバイダ | IDトークンを要求する   |
| 2 | プロバイダ |   ユーザ  | IDトークンの発行可否を聞く。あわせて認証を行う   |
| 3 | ユーザ | プロバイダ | 発行可否と、発行する場合に認証情報を送る |
| 4 | プロバイダ | クライアント | IDトークンを発行する |

※この１と４のやりとりを標準化したのがOpenID Connect
OAuthが『アクセストークンを発行する仕組み』なのに対して、OpenID Connectはこれを拡張して『IDトークンを発行する仕組み』と考えるとわかりやすいかもしれません。

>詳しいことはさておき、『Googleなどのアカウント認証を使う』=『OpenID Connectを使う』という認識がもてればいいのかな、と思います。

>Googleの認証方法はOpenID Connectではない
>OpenID Connectについて書きましたが、実際のところGoogleやTwitterの認証はOpenID Connectではありません。GoogleはOpenID Connectの仕様に準拠しつつ、OAuth 2.0を採用しています。TwitterはOAuth 1.0aという仕様で、OpenID Connectには準拠していません。
>いずれにしてもOAuthをベースにした認証を行なっていますが、ここではわかりやすさのためにOpenID Connectという用語に統一して説明しています。
