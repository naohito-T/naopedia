# Go

Go言語 = golang

## Go 歴史

昔（Go1.11以前）は`$GOPATH/src`配下でしか開発できなかった。
その後**Go modules**の導入により`$GOPATH/src`にプロジェクトを置かなければならないという制約からは解放されたので、各プロジェクト毎に`GOPATH`を指定するみたいなことがいらなくなったという経緯
そのため、こちらも現在はデフォルトから変える必要性はないです。

## Go 利用例

Go言語は比較的新しいプログラミング言語でありながら、世界的な動画配信サービスであるYouTubeのサーバー構築や有名Webアプリの開発などにも使用されており、人気の高い言語として世界中で愛されています。

利用している企業
メルカリ
ピクシブ
Gunosy（グノシー）
ぐるなび
## Go 特徴

[Go特徴](https://blog.y-yuki.net/entry/2017/05/23/130000)

Go言語はC言語やJavaなどと同じく**静的型付け言語**でありながら、PythonやJavaScriptなどの動的型付け言語のような特徴を持つ。
Go言語は**マルチプラットフォーム**に対応しており、Windows/macOS/Linux/Android/iOSなどの幅広いOSに対応している。
そのため、Webアプリケーションだけでなく、**スマートフォンで動作するアプリの開発も可能。**

Go言語のフレームワークでもある**Gobot**を使用することで、ドローンやロボットなどの高度な組込みシステムの開発も可能。
**Gobot**にはネットワーク上のデバイスや複数のデバイス間で相互に通信できる機能があり、外出先からデバイスを操作したりセンサーが反応したときに他のデバイスと機能を連動させたりできる。

Go言語は、近年注目の集まるクラウドやコンテナー技術、マイクロサービスなどの最新IT技術と親和性が高く、将来性のある言語

## Go 仕組み

コンパイル

---

## Go 開発環境構築

Dockerで構築が現実てきなのかは要調査

### 1.18 環境構築(最新)

[参考URL](https://zenn.dev/creamstew/articles/20e7a00c2eb161edbb1e)

バージョン管理ツールはいらない
Rubyならrbenv, Node.jsならnodenvなどがあるが
Goでもバージョン管理ツール必要なのかなと思って調べたら結論いらない。
理由として現状Goは広報互換性が保たれているのが理由。

現状としてGoの各種PATHは設定されているため、後は適宜Shellに対してGoのPathを追加してあげればGoのバイナリは直で打てるようになる。

## GOROOT

GoのSDKの場所を定義している

## GOPATH

ワークスペースの場所を定義している。
**グローバルインストール**したパッケージなどはすべてここに保管されている
→`$HOME/go/bin`
※Macなら$HOME/goに自分で設定してなくても勝手に設定されてるはず（Go1.8以降）

---
## Editor

vscodeで全然いい

## vscode拡張機能   

## Go Language Server Protocol

[参考URL](https://qiita.com/ryysud/items/1cf66ee4363aec22394a)

現状ではgoplsができており、ジャンプなどもすぐにできるようになる。
※ただし、`go.mod`があるディレクトリ内でファイルを開かないといけない

## Go getと installの違い

[参考URL](https://hodalog.com/use-go-install-instead-of-go-get/)

go1.17から`go get`を使わなくなったが`go get`が完全に使えなくなるわけではない

**モジュール内**で管理したいパッケージについてはこれまで通り`go get`
`go install`は**モジュール外**で使いたいパッケージのインストールに使用する

## Go とは

2009年11月にGoogleから発表されたプログラミング言語で、ソースコードをコンパイルして実行するコンパイル言語。
**Goは得に言語のコアをシンプルに、なにかを実現するときはそのシンプルな機能を組み合わせて実現するというコンセプト**

[参考URL(コードの考え方でもいい)](https://future-architect.github.io/articles/20190713/)




## GOPATHとは

>このディレクトリは、GoのソースコードやGoの実行可能ファイル、並びにコンパイル済みのパッケージファイルを保存する為に使用します。そのためこのディレクトリには３つのサブディレクトリが存在します：src、bin、pkgです。

```$HOME/.go```
が固定になったとのこと。go moduleになってからGOPATHの設定は不要になった。

## GO PATHの構成

- bin
ビルド済の実行可能ファイル群

- pkg
ビルド済のオブジェクトファイル群（拡張子は".a"）
モジュールモードのときにダウンロードされるソースコード群

- src
GOPATHモードのときにダウンロードされるソースコード群
開発するソースコードを置くディレクトリ(ここで開発することが必須ではない)


**goで開発するときは基本的にはGOPATHを意識して開発することになるのでとりあえずGOPATHを設定しておく。**

## Go のパッケージ管理方法

[参考URL](https://nishinatoshiharu.com/go-modules-history/)

Go言語のパッケージ管理方法にはGOPATHモードとmodule-awareモードの2種類が存在する。

- GOPATH モードについて
- module-awareモード

## Go: DepからGo Modulesへの以降

**Goのモジュール管理のdepはもう古い**
Go modulesはGo 1.13から正式に導入されたGo言語公式の依存パッケージ管理ツール
**Go modules以前は、depが依存パッケージ管理のツールとしてはデファクトだった。**

---

ここからは昨今のGo moduleでの環境のsetupについて

## Go moduleとは

[参考URL](https://zenn.dev/nobonobo/articles/4fb018a24f9ee9)

Go moduleモードでは、**GOPATH配下にプロジェクトを置かなければならないという制約からは解放された。**
なので実質、GOPATHはどこをさしても構わないし、設定をされていなくてもUser/goというデフォルトの場所が決まっているため開発が楽。

- モジュールとパッケージとは
モジュール = パッケージを一つまたは複数のサブパッケージを取りまとめたカタマリ
パッケージ = フォルダ単位で単一ファイルまたは複数ファイルのかたまり
サブパッケージ = サブフォルダにおくだけで扱いはパッケージと同等

あるフォルダにてモジュールだと宣言するとそのフォルダ以下がモジュールになる。
宣言方法は以下の通り

```$ go mod init <モジュール名>```

こうするとカレントフォルダにgo.modファイルが作成され、このカレントフォルダ以下がまるっと「モジュール」の扱いになります。

パッケージ名とはパッケージに置かれるGoコードの先頭に宣言される名称で、これは極力そのパッケージのフォルダ名と合致させることが推奨されます

相対パスインポートを見たらそのコードは古い可能性が高いので参考にしない様に。

## Go module始め方

`$ go mod init [import name]`

- go mod initの名前は？

書くべきなのは importpath
一般的な用途ではリポジトリルートのURLを「importpath」としてgo mod initの引数に使うのが良いでしょう。
go mod init sampleについてはリポジトリと紐づけない一時的なものとして利用することはできます。こうして作られたモジュールは公開する条件を満たせないので例えリポジトリに置いて公開しても第三者がgo-getすることはできないモジュールになります。もちろんこの形での公開は推奨はされません。（手元で書き捨てる用途とか学習用途とお考え下さい）

## go.mod と go.sum

[参考URL](https://zenn.dev/ryo_yamaoka/articles/595cf9e69229f9)

- go.mod
主にモジュールのインポートパスとバージョン情報を書いておくためのファイルで、いくつかのディレクティブを使って、アプリケーションがどのような依存関係を持っているか記述しておく

**go mod tidy等を実行するとこのファイルを元に依存先を取得し次項で解説するgo.sumを生成する。**

- go.sum
直接・間接問わずに依存先モジュールのハッシュを記録するためのファイル

## go プロジェクト version固定


## go get

- example
`$ go get github.com/labstack/echo/v4`

- option

-u : 新しいマイナーリリースまたはパッチリリースが利用可能な場合にインストール
-d : パッケージのダウンロードのみ、インストールなし(PCに組み込まないということ)
-tオプション : 指定されたパッケージのテストに必要なパッケージも一緒にダウンロードしてくれる。
-vオプション :実行しているコマンドを表示する。
-fixオプション : 依存関係を修正。ダウンロードしたパッケージを修正。修正してからgetをしてくれる。
-insecureオプション : HTTP等の安全性が確保されていない方式を使いリポジトリから取得するためのコマンド。危険が伴うため、使用はオススメしません。

## tool-version

asdf用のようだ、、

[tool-versions参考URL](https://developers.ysd.co.jp/post/u-aiaa/golang/webapi.a/)

Go言語の準備
asdf
Go言語のインストール/バージョン管理に asdf を使ってみます。

asdf とは、各言語やツールのバージョン管理等をおこなえる CLI ツールです。

asdf が対応している言語等は、Plugin List より確認できます。

プロジェクト等のディレクトリに .tool-versions ファイルを作成し、各言語やツールのバージョンを指定しておくと、そのバージョンのものが使用できます。 詳細は Set Current Version を参考にしてください。

asdfのインストールより、 Operating System , Installation Method を選んで、手順通りにインストールします。



$ echo "golang 1.15.3" > .tool-versions

$ go version
go version go1.15.3 darwin/amd64

## go admin


## Tips

[Go並列処理](https://zenn.dev/hsaki/books/golang-concurrency/viewer)
[とほほのGo言語入門](https://www.tohoho-web.com/ex/golang.html)

## Goを学ぶ時につまずきやすいポイント

[参考URL](https://future-architect.github.io/articles/20190713/)