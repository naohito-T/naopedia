# Go

Go言語 = golang

## Goを学ぶ時につまずきやすいポイント

[参考URL](https://future-architect.github.io/articles/20190713/)

## Go とは

2009年11月にGoogleから発表されたプログラミング言語で、ソースコードをコンパイルして実行するコンパイル言語。
**Goは得に言語のコアをシンプルに、なにかを実現するときはそのシンプルな機能を組み合わせて実現するというコンセプト**

[参考URL(コードの考え方でもいい)](https://future-architect.github.io/articles/20190713/)

## Go 特徴

Go言語はC言語やJavaなどと同じく静的型付け言語でありながら、PythonやJavaScriptなどの動的型付け言語のような特徴を持つ。
Go言語はマルチプラットフォームに対応しており、Windows/MacOS X/Linux/Android/iOSなどの幅広いOSに対応しています。そのため、Webアプリケーションだけでなく、スマートフォンで動作するアプリの開発も可能。
Go言語のフレームワークでもある「Gobot」を使用することで、ドローンやロボットなどの高度な組込みシステムの開発も可能です。Gobotにはネットワーク上のデバイスや複数のデバイス間で相互に通信できる機能があり、外出先からデバイスを操作したりセンサーが反応したときに他のデバイスと機能を連動させたりできます。

Go言語は、近年注目の集まるクラウドやコンテナ技術、マイクロサービスなどの最新IT技術と親和性が高く、将来性のある言語です。


## GOPATHとは

>このディレクトリは、GoのソースコードやGoの実行可能ファイル、並びにコンパイル済みのパッケージファイルを保存する為に使用します。そのためこのディレクトリには３つのサブディレクトリが存在します：src、bin、pkgです。

```$HOME/.go```
が固定になったとのこと。go moduleになってからGOPATHの設定は不要になった。

## GO PATHの構成

- bin
ビルド済の実行可能ファイル群

- pkg
ビルド済のオブジェクトファイル群（拡張子は".a"）
モジュールモードのときにダウンロードされるソースコード群

- src
GOPATHモードのときにダウンロードされるソースコード群
開発するソースコードを置くディレクトリ(ここで開発することが必須ではない)


**goで開発するときは基本的にはGOPATHを意識して開発することになるのでとりあえずGOPATHを設定しておく。**

## Go のパッケージ管理方法

[参考URL](https://nishinatoshiharu.com/go-modules-history/)

Go言語のパッケージ管理方法にはGOPATHモードとmodule-awareモードの2種類が存在する。

- GOPATH モードについて
- module-awareモード

## Go: DepからGo Modulesへの以降

**Goのモジュール管理のdepはもう古い**
Go modulesはGo 1.13から正式に導入されたGo言語公式の依存パッケージ管理ツール
**Go modules以前は、depが依存パッケージ管理のツールとしてはデファクトだった。**

---

ここからは昨今のGo moduleでの環境のsetupについて

## Go moduleとは

[参考URL](https://zenn.dev/nobonobo/articles/4fb018a24f9ee9)

Go moduleモードでは、GOPATH配下にプロジェクトを置かなければならないという制約からは解放された。
なので実質、GOPATHはどこをさしても構わないし、設定をされていなくてもUser/goというデフォルトの場所が決まっているため開発が楽。

- モジュールとパッケージとは
モジュール = パッケージを一つまたは複数のサブパッケージを取りまとめたカタマリ
パッケージ = フォルダ単位で単一ファイルまたは複数ファイルのかたまり
サブパッケージ = サブフォルダにおくだけで扱いはパッケージと同等

あるフォルダにてモジュールだと宣言するとそのフォルダ以下がモジュールになる。
宣言方法は以下の通り

```$ go mod init <モジュール名>```

こうするとカレントフォルダにgo.modファイルが作成され、このカレントフォルダ以下がまるっと「モジュール」の扱いになります。

パッケージ名とはパッケージに置かれるGoコードの先頭に宣言される名称で、これは極力そのパッケージのフォルダ名と合致させることが推奨されます

相対パスインポートを見たらそのコードは古い可能性が高いので参考にしない様に。

## Go module始め方

`$ go mod init [import name]`

- go mod initの名前は？

書くべきなのは importpath
一般的な用途ではリポジトリルートのURLを「importpath」としてgo mod initの引数に使うのが良いでしょう。
go mod init sampleについてはリポジトリと紐づけない一時的なものとして利用することはできます。こうして作られたモジュールは公開する条件を満たせないので例えリポジトリに置いて公開しても第三者がgo-getすることはできないモジュールになります。もちろんこの形での公開は推奨はされません。（手元で書き捨てる用途とか学習用途とお考え下さい）

## go.mod と go.sum

[参考URL](https://zenn.dev/ryo_yamaoka/articles/595cf9e69229f9)

- go.mod
主にモジュールのインポートパスとバージョン情報を書いておくためのファイルで、いくつかのディレクティブを使って、アプリケーションがどのような依存関係を持っているか記述しておく

**go mod tidy等を実行するとこのファイルを元に依存先を取得し次項で解説するgo.sumを生成する。**

- go.sum
直接・間接問わずに依存先モジュールのハッシュを記録するためのファイル

## go プロジェクト version固定


## go get

- example
`$ go get github.com/labstack/echo/v4`

- option

-u : 新しいマイナーリリースまたはパッチリリースが利用可能な場合にインストール
-d : パッケージのダウンロードのみ、インストールなし(PCに組み込まないということ)
-tオプション : 指定されたパッケージのテストに必要なパッケージも一緒にダウンロードしてくれる。
-vオプション :実行しているコマンドを表示する。
-fixオプション : 依存関係を修正。ダウンロードしたパッケージを修正。修正してからgetをしてくれる。
-insecureオプション : HTTP等の安全性が確保されていない方式を使いリポジトリから取得するためのコマンド。危険が伴うため、使用はお勧めしません。

## tool-version

asdf用のようだ、、

[tool-versions参考URL](https://developers.ysd.co.jp/post/u-aiaa/golang/webapi.a/)

Go 言語の準備
asdf
Go 言語のインストール/バージョン管理に asdf を使ってみます。

asdf とは、各言語やツールのバージョン管理等をおこなえる CLI ツールです。

asdf が対応している言語等は、Plugin List より確認できます。

プロジェクト等のディレクトリに .tool-versions ファイルを作成し、各言語やツールのバージョンを指定しておくと、そのバージョンのものが使用できます。 詳細は Set Current Version を参考にしてください。

asdfのインストールより、 Operating System , Installation Method を選んで、手順通りにインストールします。



$ echo "golang 1.15.3" > .tool-versions

$ go version
go version go1.15.3 darwin/amd64

## go admin


