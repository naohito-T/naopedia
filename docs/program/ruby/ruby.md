# Ruby

[他言語からRuby入門について](https://www.ruby-lang.org/ja/documentation/ruby-from-other-languages/)

## Ruby他言語との違い

Perlの多くの部分を踏襲したRubyでしたが、1点決定的に異なる部分があります。それがRubyが純粋なオブジェクト指向言語である、という点。

後からオブジェクト指向の仕組みを取り入れたPHPとは異なり、**Rubyは最初からオブジェクト指向で記述できるよう開発された言語。実行はインタプリタ方式**

Ruby on Railsを使用した場合の最大のメリットは、**開発スピードで低予算でWebアプリを簡単に作ることができること。**

## Rubyのインデント

スペース2が基本

## Ruby コンパイラとインタプリタ

Rubyはインタプリタ型のプログラミング言語。
Rubyプログラムが記述されたソースコードを逐次解釈して実行する。
**Ruby 1.9以降の言語実装(YARV)では処理を高速化するためにテキストコードをいったん独自のバイナリーコードに変換してから実行する。**
現在のRubyはコンパイラとインタプリタの中間言語といえる。

## Rubyによってできること

1. Webアプリケーション
2. WebAPI
3. スクレイピング
4. スマホアプリ
5. 機会学習

## すべては値

式と文に違いはありません。 すべては値を持ちます。nilであっても例外ではありません。 Rubyでは次のように書くことが可能
**※if文を変数に入れることができる**

```ruby
x = 10
y = 11
z = if x < y
      true
    else
      false
    end
z # => true
```

## 不思議なメソッド名

Rubyでは、メソッド名の最後に疑問符(?)や感嘆符(!)が使われることがあります。 慣習的に、問い合わせ系のメソッドの最後には疑問符が使われます (例: レシーバが空の場合にtrueを返すArray#empty?)。 また、使用に危険を伴うメソッドの最後には感嘆符が使われます (例: selfあるいは引数の内容を書き換えるようなメソッド。exit!など)。 けれど、危険なメソッドすべてがこの慣習に従っているわけでも ないことに注意してください。 Array#replaceは、与えられた配列の内容で配列の内容を置き換えます。 この操作は、自身を変更しないようなメソッド名とは意に反する振る舞いをします。

## 時間

```ruby
Time.current
# Railsの独自のメソッドで、TimeWithZoneクラスを使用している。
# config.time_zone で設定したタイムゾーンを元に現在時刻を取得する。

Time.now
# Timeクラスを使用している。
# 環境変数TZの値。なければシステム(OS)のタイムゾーンを元に現在時刻を取得する。
```

## Ruby 定数

[参考URL](https://qiita.com/fursich/items/a1b742795cf10eebc73f)

- 定数参照
::演算子
>あるクラスまたはモジュールで定義された定数を外部から参照する ためには::演算子を用います。またObjectクラスで 定義されている定数(トップレベルの定数と言う)を確実に参照する ためには左辺無しの::演算子が使えます。

## $LOAD_PATHとは

ファイルを読み込むRubyのメソッド`load`や`require`がファイルを参照する時に使われるディレクトリパス群
application.rbにもrequire "rails"などと言った記述がありますが、これだけでどうやってRailsのGemファイルを参照しているのか疑問だが、$LOAD_PATHにパスが設定されているため。

## ブロック構文

Rubyに組み込まれたメソッドの中には、ブロック構文を使って処理や条件を指定可能なメソッドがある。

Rubyで使えるメソッドの中には引数の他に、`do ~ end`または`{}`で囲まれたブロック構文を利用するメソッドが多い。

**そして、ブロック構文は、doで始まり、endまでが範囲です。また、省略して{}で囲む書き方も可能。**

- ブロック構文の使い分け
厳密な違いは結合の強さが違い、`{}`が優先されるが、

## Rubyにおけるメソッドの呼び出し方

Rubyでメソッドを呼び出す場合、次の2種類があり、**どちらの方法が使われるかはメソッドによる**

1. メソッドと引数で呼び出す

メソッド名のみ、または、メソッドに続けて括弧内に引数を指定する方法です。引数は、値や変数の他、式も記述できます。

```ruby
hoge
hoge()
```

2. ブロック付きメソッドで呼び出す

do～endまたは{}で囲った制御構造を付けてメソッドを呼び出す方法です。eachメソッドなど、繰り返し処理の内容を記述する場合などで使われます。そして、do～end、または、{}内の制御構造がブロック構文です。

```ruby
hoge do 制御構造 end

hoge { 制御構造 }
```

## Rubyの変数

[変数](image/変数.png)

## Rubyでの文の終わり方

Rubyでは文の終わりを示すためのセミコロン(;)はない。
**改行が文の終わりとみなす**
そのため以下は一つの文
a = true; b = true; c = false;

## 数値

かつてFixnumクラスとBignumクラスがあった
現在はIntegerとFloatの2つがある。

気をつけこと

1. IntegerとFloatを計算したら自動的にFloatに変換される。
2. 整数同士の割り算の結果は常に整数になる。

## 文字列

気をつけること

1. テンプレートリテラルは二重引用符(")で囲まれた文字列の中に#{}があると展開してくれる。
2. **数字と文字列の連結** と **>で比較したりするとエラーとなる。**

## 配列

要素の番号は0から始まる。
現在の要素数より、大きな番号を指定して要素を取り出すと、何もないことを表すnilが返される

気をつけること
1. 要素数の数より大きな数を指定して要素を入れると可変してくれる。

```ruby
irb(main):011:0> ani = ['a','b','c']
irb(main):012:0> ani[8] = 'd'
irb(main):013:0> puts ani
a
b
c





d
=> nil
```

2. 配列に要素として、様々な雑多なオブジェクトを入れることができる(文字列・数字・オブジェクトをごちゃまぜ可能)
3. %w()の中にスペースで区切って文字列を並べると配列を簡潔に記述できる。文字列の中で式展開などを使いたい場合は%W()を使う

## デバッグで使うメソッド

inspect
オブジェクトの内容を読みやすい形にした文字列を返す。

p
putsと同じ結果を返す


## 式

**式は何らかの値を返す**
Rubyでは式と文の区別はあまりない(if文の結果を変数に入れられるため)

## 演算子

気をつけること

```ruby
=~ # 文字列と正規表現が一致するかを判定するRubyの演算子
```

## 条件式

気をつけること
条件式の結果は c = (a == b)のように取り出すことができる。trueかfalseを返す

a == bのようにある条件が成立しているかどうかを調べる式を**条件式という**

- 論理演算子
![論理](image/論理演算子.png)

## falsyな値

気をつけること

**0と空文字は真になる** → JSではfalseになっていた

条件式がfalseになるのは
falseかnilの時だけ


## if文

気をつけること
1. falsyな値に気をつける

if文を1行で終わらしたい場合
`if num % 2 == 0 then puts "偶数です" end`
※thenが必要

2. 後置のifを頻繁に使う

trueだったらputsをする。
`puts "偶数" if num % 2 == 0`

## unless

**条件式が正しくないときに**プログラムを実行する

```ruby
unless num % 2 == 0
  puts "偶数ではない"
end
```

**ifと同様に後置のunlessも使える**


